{"version":3,"sources":["../../../../../src/components/form/components/date-input/date-input.jsx"],"names":["DateInput","props","context","passBackError","name","error","registerComponent","data","state","defaultValue","defaultError","returnedErrors","hasError","Object","keys","forEach","key","root","setState","multiErrors","type","ref","monthRef","yearRef","value","length","current","focus","element","editedMultiErrors","includes","autoSelectNext","sanitizedValue","sanitizeInput","updatedData","autoSelectNextFunction","updateFormState","React","createRef","initialiseComponent","children","multiComponentMode","Children","child","Day","day","Month","month","year","Year","registerMultiComponent","registerSingleComponent","className","style","label","id","hint","labelHtmlFor","rest","parentError","contextValue","handleInput","registerRef","passBackErrorFromComponent","PureComponent","FormContext","onlyNumbers","replace","slice"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport stylePropType from 'react-style-proptype';\nimport FormContext from '../../FormContext';\nimport DateContext from './DateContext';\nimport Label from '../../../label';\nimport Hint from '../../../hint';\nimport ErrorMessage from '../../../error-message';\nimport Day from './day';\nimport Month from './month';\nimport Year from './year';\n\nconst valuePropType = {\n  day: PropTypes.string,\n  month: PropTypes.string,\n  year: PropTypes.string\n};\n\nexport default class DateInput extends PureComponent {\n  static contextType = FormContext;\n\n  static Day = Day;\n\n  static Month = Month;\n\n  static Year = Year;\n\n  static propTypes = {\n    children: PropTypes.node,\n    className: PropTypes.string,\n    style: stylePropType,\n    label: PropTypes.string,\n    hint: PropTypes.string,\n    error: PropTypes.string,\n    id: PropTypes.string,\n    labelHtmlFor: PropTypes.string,\n    name: PropTypes.string.isRequired,\n    autoSelectNext: PropTypes.bool,\n    value: valuePropType\n  };\n\n  static defaultProps = {\n    children: null,\n    className: '',\n    style: {},\n    label: '',\n    hint: '',\n    error: '',\n    id: '',\n    labelHtmlFor: '',\n    autoSelectNext: false,\n    value: { day: '', month: '', year: '' }\n  };\n\n  static sanitizeInput = (type, value) => {\n    const onlyNumbers = value.replace(/\\D/g, '');\n    if (type === 'day') {\n      return onlyNumbers.slice(0, 2);\n    }\n    if (type === 'month') {\n      return onlyNumbers.slice(0, 2);\n    }\n    return onlyNumbers.slice(0, 4);\n  };\n\n  constructor(props, context) {\n    super(props, context);\n    this.state = {\n      data: {\n        value: props.value,\n      },\n      multiErrors: {}\n    };\n    this.monthRef = React.createRef();\n    this.yearRef = React.createRef();\n    this.initialiseComponent();\n  }\n\n  componentDidUpdate = () => {\n    const { passBackError } = this.context;\n    const { name, error } = this.props;\n    if (passBackError) {\n      passBackError(name, !!error, error);\n    }\n  };\n\n  registerSingleComponent = () => {\n    const { passBackError, registerComponent } = this.context;\n    const { name, error } = this.props;\n    if (passBackError) {\n      passBackError(name, !!error, error);\n    }\n    if (registerComponent) {\n      const { data } = this.state;\n      registerComponent(name, data);\n    }\n  };\n\n  registerMultiComponent = (defaultValue, defaultError) => {\n    const { passBackError, registerComponent } = this.context;\n    const { name, error } = this.props;\n    if (registerComponent) registerComponent(name, defaultValue);\n    if (passBackError) {\n      const returnedErrors = {};\n      let hasError = false;\n      Object.keys(defaultError).forEach(key => {\n        if (defaultError[key]) {\n          returnedErrors[key] = defaultError[key];\n          hasError = true;\n        }\n      });\n      if (error) {\n        returnedErrors.root = error;\n        hasError = true;\n      }\n      this.setState({ multiErrors: returnedErrors }, () => {\n        passBackError(name, hasError, returnedErrors);\n      });\n    }\n  };\n\n  registerRef = (type, ref) => {\n    if (type === 'month') {\n      this.monthRef = ref;\n    } else if (type === 'year') {\n      this.yearRef = ref;\n    }\n  };\n\n  autoSelectNextFunction = (type, value) => {\n    if (type === 'day' && value.length === 2) {\n      if (this.monthRef.current !== null) this.monthRef.focus();\n    } else if (type === 'month' && value.length === 2) {\n      if (this.yearRef.current !== null) this.yearRef.focus();\n    }\n  };\n\n  passBackErrorFromComponent = (element, value) => {\n    const { name } = this.props;\n    const { passBackError } = this.context;\n    const { multiErrors } = this.state;\n    const editedMultiErrors = multiErrors;\n    if (value) {\n      editedMultiErrors[element] = value;\n    } else if (Object.keys(multiErrors).includes(element)) {\n      delete editedMultiErrors[element];\n    }\n    if (multiErrors !== editedMultiErrors) {\n      this.setState({ multiErrors: editedMultiErrors }, () => {\n        const hasError = Object.keys(editedMultiErrors).length > 0;\n        passBackError(name, hasError, editedMultiErrors);\n      });\n    }\n  };\n\n  handleInput = (type, value) => {\n    const { autoSelectNext, name } = this.props;\n    const { data } = this.state;\n    const sanitizedValue = DateInput.sanitizeInput(type, value);\n    const updatedData = { ...data, [type]: sanitizedValue };\n    this.setState({ data: updatedData }, () => {\n      if (autoSelectNext) this.autoSelectNextFunction(type, sanitizedValue);\n      const { updateFormState } = this.context;\n      if (updateFormState) {\n        updateFormState(name, updatedData);\n      }\n    });\n  };\n\n  initialiseComponent() {\n    const { children } = this.props;\n    let multiComponentMode = false;\n    const defaultError = {};\n    const defaultValue = {};\n    React.Children.forEach(children, child => {\n      if (child === null) return;\n      const { type } = child;\n      const { value, error } = child.props;\n      if (type === DateInput.Day) {\n        defaultValue.day = value;\n        defaultError.day = error;\n        multiComponentMode = true;\n      } else if (type === DateInput.Month) {\n        defaultValue.month = value;\n        defaultError.year = error;\n        multiComponentMode = true;\n      } else if (type === DateInput.Year) {\n        defaultValue.year = value;\n        defaultError.year = error;\n        multiComponentMode = true;\n      }\n    });\n\n    if (multiComponentMode) {\n      this.registerMultiComponent(defaultValue, defaultError);\n    } else {\n      this.registerSingleComponent();\n    }\n  }\n\n  render() {\n    const {\n      children,\n      className,\n      style,\n      label,\n      id,\n      hint,\n      error,\n      labelHtmlFor,\n      name,\n      value,\n      autoSelectNext,\n      ...rest\n    } = this.props;\n    const { data, multiErrors } = this.state;\n    const parentError = Object.keys(multiErrors).length > 0 ? false : !!error;\n    const contextValue = {\n      handleInput: this.handleInput,\n      registerRef: this.registerRef,\n      passBackError: this.passBackErrorFromComponent,\n      parentError,\n      name,\n      ...data\n    };\n\n    return (\n      <>\n        {label ? <Label htmlFor={labelHtmlFor}>{label}</Label> : null}\n        {hint ? <Hint>{hint}</Hint> : null}\n        {error ? <ErrorMessage>{error}</ErrorMessage> : null}\n        <div className={className} style={style} id={id}>\n          <DateContext.Provider value={contextValue}>\n            {children || (\n              <>\n                <Day {...rest} value={value && value.day || ''} />\n                <Month {...rest} value={value && value.month || ''} />\n                <Year {...rest} value={value && value.year || ''} />\n              </>\n            )}\n          </DateContext.Provider>\n        </div>\n      </>\n    );\n  }\n}\n"],"file":"date-input.js"}